-- Dịch vụ cần thiết
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

-- Biến trạng thái
local infiniteJumpEnabled = false
local localPlayer = Players.LocalPlayer

-- --- PHẦN TẠO GUI (GIAO DIỆN) ---

-- Xóa GUI cũ nếu đã tồn tại để tránh bị trùng lặp
if CoreGui:FindFirstChild("InfJumpGUI") then
	CoreGui:FindFirstChild("InfJumpGUI"):Destroy()
end

-- Tạo ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "InfJumpGUI"
-- Cố gắng đưa vào CoreGui (an toàn hơn trong executor), nếu không được thì đưa vào PlayerGui
pcall(function()
	screenGui.Parent = CoreGui
end)
if not screenGui.Parent then
	screenGui.Parent = localPlayer:WaitForChild("PlayerGui")
end

-- Tạo Nút bấm chính (Button)
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Parent = screenGui
toggleButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35) -- Màu nền tối
toggleButton.Position = UDim2.new(0, 20, 0, 50) -- Vị trí trên cùng bên trái (cách lề một chút)
toggleButton.Size = UDim2.new(0, 150, 0, 50) -- Kích thước nút
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Text = "INF JUMP: OFF"
toggleButton.TextColor3 = Color3.fromRGB(255, 100, 100) -- Màu chữ đỏ (khi tắt)
toggleButton.TextSize = 16
toggleButton.AutoButtonColor = false -- Tắt màu mặc định của Roblox để dùng Tween

-- Trang trí nút (Bo góc)
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 12)
uiCorner.Parent = toggleButton

-- Trang trí nút (Viền)
local uiStroke = Instance.new("UIStroke")
uiStroke.Parent = toggleButton
uiStroke.Color = Color3.fromRGB(60, 60, 60)
uiStroke.Thickness = 2
uiStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Hiệu ứng bóng đổ (Shadow)
local shadow = Instance.new("ImageLabel")
shadow.Name = "Shadow"
shadow.Parent = toggleButton
shadow.BackgroundTransparency = 1
shadow.Position = UDim2.new(0, -15, 0, -15)
shadow.Size = UDim2.new(1, 30, 1, 30)
shadow.ZIndex = 0
shadow.Image = "rbxassetid://5554236805"
shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
shadow.ScaleType = Enum.ScaleType.Slice
shadow.SliceCenter = Rect.new(23, 23, 277, 277)
shadow.ImageTransparency = 0.4

-- --- PHẦN CHỨC NĂNG (LOGIC) ---

-- Hàm cập nhật giao diện khi bấm nút
local function updateButtonVisuals()
	local targetColor
	local targetTextColor
	local targetText
	local strokeColor

	if infiniteJumpEnabled then
		targetColor = Color3.fromRGB(46, 204, 113) -- Màu xanh lá (ON)
		targetTextColor = Color3.fromRGB(255, 255, 255)
		targetText = "INF JUMP: ON"
		strokeColor = Color3.fromRGB(39, 174, 96)
	else
		targetColor = Color3.fromRGB(35, 35, 35) -- Màu tối (OFF)
		targetTextColor = Color3.fromRGB(255, 100, 100)
		targetText = "INF JUMP: OFF"
		strokeColor = Color3.fromRGB(60, 60, 60)
	end

	-- Sử dụng Tween để chuyển màu mượt mà
	TweenService:Create(toggleButton, TweenInfo.new(0.3), {BackgroundColor3 = targetColor}):Play()
	TweenService:Create(toggleButton, TweenInfo.new(0.3), {TextColor3 = targetTextColor}):Play()
	TweenService:Create(uiStroke, TweenInfo.new(0.3), {Color = strokeColor}):Play()
	toggleButton.Text = targetText
end

-- Sự kiện click chuột
toggleButton.MouseButton1Click:Connect(function()
	infiniteJumpEnabled = not infiniteJumpEnabled
	updateButtonVisuals()
end)

-- Sự kiện nhảy (Infinite Jump Logic)
UserInputService.JumpRequest:Connect(function()
	if infiniteJumpEnabled then
		if localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid") then
			localPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
		end
	end
end)

-- Thông báo khi script chạy xong
game:GetService("StarterGui"):SetCore("SendNotification", {
	Title = "Success";
	Text = "Infinite Jump GUI đã được tải!";
	Duration = 3;
})
